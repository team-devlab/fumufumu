# 📘 API設計ドキュメント運用ガイド
このドキュメントは、API設計書を参照・作成・更新する際の**「取扱説明書」**として機能します。

## 1. 📂 ドキュメント構成とファイルの役割

API設計に関する全てのドキュメントは、`docs/design/api` ディレクトリ以下で管理します。

| ファイル/フォルダ | 役割 | 備考 |
| :--- | :--- | :--- |
| `README.md` (このファイル) | **運用ルール。** 設計書の作成・更新手順、基本ルールを定義。 | |
| `schemas.md` | **共通データ構造のマスター定義。** `User`, `ErrorResponse`など、全てのAPIで利用されるモデルを定義。 | 個別のAPI定義は行いません。 |
| `api-design-template.md` | **新規ドメイン追加時の雛形。** | 新しいドメインを追加し、API設計ファイルを新しく作成する場合にコピーして利用してください。既存ドメインに関連するAPIを追加する時は、既存の設計書内に記載してください。 |
| `api-[DOMAIN].md` | **個別ドメインのAPI設計書。** （例: `api-user.md`, `api-consultation.md`） | **1ドメイン（モデル）につき1ファイル**で、CRUD操作その他を全て記述します。 |

---

## 2. 📝 API設計書の基本ルールとスタイル

設計書の一貫性と手軽さを維持するため、一旦以下のルールで運用しています。

### A. スタイルと記述方法

- **記述形式:** **「不揃い許容のYAMLライクなコードブロック」** (` ```text `) を使用しています。縦列を揃えるための余分なスペース調整は**不要**です。（好みによりやってもいいです。その場合、エディタのフォーマットなどを利用できると手間が省けます。）
- **参照方法:** 共通スキーマを参照する場合は、必ず `ref` キーワードを使用し、`schemas.md` に定義されているモデルを参照します。
  - 例: `user: ref # Userオブジェクトを参照`
  - 例: `meta: ref # PaginationMetaオブジェクトを参照`

### B. タグの利用（分類キー）

APIエンドポイントには、以下の分類タグをなるべく付与してください。これにより、将来的な自動化やドキュメントの整理が容易になります。

- **`[domain]`:** そのAPIが操作するモデル名（例: `user`, `consultation`）。
- **`[operation]`:** そのAPIの操作内容（`create`, `read`, `update`, `delete`, `list` など）。

---

## 3. ✍️ 新規API・ドメインの追加手順

新しいドメイン（モデル）やAPIを追加する場合は、以下の手順を参考にドキュメントを更新してください。

### A. 新しいドメイン（モデル）を追加する場合

1.  **共通スキーマの定義:** 新しいドメインの構造を、**`SCHEMAS.md`** の末尾に追記します。
2.  **ファイルの作成:** `api-design-template.md` をコピーし、`api-[新しいドメイン名].md` として保存します。
3.  **メタ情報の更新:** 新しいファイル内の `[ドメイン名]` と `対象ドメイン` を、新しいモデル名に置き換えます。
4.  **エンドポイントの定義:** CRUD操作の雛形などを参考に、必要なAPIを定義します。

### B. 既存のAPIを変更・修正する場合

1.  **互換性の確認:** フィールドの削除や必須パラメータ化など、既存クライアントの**非互換な変更はなるべく避けられる方がいいです**。どうしても必要な場合はその限りではありません。
2.  **対応ファイルの修正:** 変更対象の `api-[DOMAIN].md` を開き、該当セクションを修正します。
3.  **ドキュメントバージョンの更新:** 修正を反映したら、`api-[新しいドメイン名].md`内に存在するメタ情報に**「ドキュメントバージョン」**という項目があります。その項目をインクリメント（例: `v1` → `v2`）します。変更内容はPull Requestに必ず記載してください。
